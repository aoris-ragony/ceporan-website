---
// src/components/Header.astro
const pathname = new URL(Astro.request.url).pathname;
const currentPath = pathname.slice(1); 


---

<header class="site-header">
  <div class="container">
    
    {/* LOGO & NAMA DESA */}
    <a href="/" class="brand">
      {/* Ganti src dengan lokasi logo Anda jika ada, misal /logo.png */}
      <img src="/kab_klaten_1.png" alt="Logo" class="logo" /> 
      <div class="brand-text">
        <span class="desa-name">DESA CEPORAN</span>
        <span class="kab-name">Kecamatan Gantiwarno, Kabupaten Klaten</span>
      </div>
    </a>

    {/* MENU DESKTOP (Layar Besar) */}
    <nav class="desktop-nav">
      <a href="/" class={currentPath === "" ? "active" : ""}>Beranda</a>
      
      {/* Perbaikan Link: Pakai /#profil agar bisa scroll dari halaman lain */}
      <a href="/#profil">Profil</a> 
      
      <a href="/#news" class={currentPath.startsWith("news") ? "active" : ""}>Berita</a>
      <a href="/#contact" class={currentPath.startsWith("kontak") ? "active" : ""}>Kontak</a>
    </nav>

    {/* TOMBOL MENU MOBILE (Hamburger) */}
    <button id="mobile-menu-btn" class="hamburger" aria-label="Menu">
      <span></span>
      <span></span>
      <span></span>
    </button>
  </div>

  {/* MENU MOBILE (Slide samping/Overlay) */}
  <div id="mobile-nav" class="mobile-nav">
    <div class="mobile-nav-content">
        
        {/* Header Menu Mobile (Tombol Close) */}
        <div class="mobile-header">
            <span class="menu-title">Menu</span>
            <button id="close-menu-btn" class="close-btn">&times;</button>
        </div>

        {/* Daftar Link Mobile */}
        <div class="mobile-links">
            <a href="/">Beranda</a>
            <a href="/#profil">Profil</a>
            <a href="/#news">Berita</a>
            <a href="/#contact">Kontak</a>
        </div>
    </div>
  </div>
</header>

<script>
  document.addEventListener('DOMContentLoaded', () => {

    // --- 1. LOGIKA MENU MOBILE (JANGAN DIUBAH) ---
    const menuBtn = document.getElementById('mobile-menu-btn');
    const closeBtn = document.getElementById('close-menu-btn');
    const mobileNav = document.getElementById('mobile-nav');
    
    function toggleMenu() {
      if (mobileNav) {
        mobileNav.classList.toggle('active');
        document.body.style.overflow = mobileNav.classList.contains('active') ? 'hidden' : '';
      }
    }

    if (menuBtn) menuBtn.addEventListener('click', toggleMenu);
    if (closeBtn) closeBtn.addEventListener('click', toggleMenu);

    // Tutup menu saat link diklik
    if (mobileNav) {
      const mobileLinks = mobileNav.querySelectorAll('a');
      mobileLinks.forEach(link => {
        link.addEventListener('click', () => {
          mobileNav.classList.remove('active');
          document.body.style.overflow = '';
        });
      });
    }


    // --- 2. LOGIKA SCROLL TO TOP (REVISI TOTAL) ---
    
    // Ambil semua link yang mengarah ke "/" (Logo & Teks Beranda)
    const homeLinks = document.querySelectorAll('a[href="/"]');

    homeLinks.forEach(link => {
      link.addEventListener('click', (e) => {
        
        // LANGKAH 1: Matikan fungsi link asli (agar tidak reload otomatis)
        e.preventDefault();

        // LANGKAH 2: Cek apakah kita sedang di halaman depan?
        const currentPath = window.location.pathname;
        const isHomePage = currentPath === '/' || currentPath === '/index.html';

        if (isHomePage) {
          // KONDISI A: Sedang di Home -> Scroll ke Atas
          window.scrollTo({
            top: 0,
            left: 0,
            behavior: 'smooth' // Gerakan halus
          });
          
          // Opsional: Bersihkan URL (hapus #profil dsb)
          history.replaceState(null, null, ' ');

        } else {
          // KONDISI B: Tidak di Home -> Pindah Halaman Manual
          window.location.href = '/';
        }

      });
    });

  });
</script>

<style>
  /* --- STYLE UTAMA HEADER --- */
  .site-header {
    background: #fff;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    position: sticky;
    top: 0;
    z-index: 1000;
    padding: 0.5rem 0;
  }

  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 1.5rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  /* --- BRAND / LOGO --- */
  .brand {
    display: flex;
    align-items: center;
    gap: 12px;
    text-decoration: none;
  }
  
  .logo {
    height: 45px; /* Sesuaikan ukuran logo */
    width: auto;
  }

  .brand-text {
    display: flex;
    flex-direction: column;
  }

  .desa-name {
    font-weight: 800;
    color: #1a56db; /* Biru Utama */
    font-size: 1.1rem;
    line-height: 1.2;
    text-transform: uppercase;
  }

  .kab-name {
    font-size: 0.7rem;
    color: #6b7280;
  }

  /* --- MENU DESKTOP --- */
  .desktop-nav {
    display: none; /* Sembunyi di HP */
  }

  @media (min-width: 768px) {
    .desktop-nav {
      display: flex;
      gap: 2rem;
    }
    
    .desktop-nav a {
      text-decoration: none;
      color: #374151;
      font-weight: 600;
      font-size: 0.95rem;
      transition: color 0.2s;
    }

    .desktop-nav a:hover, .desktop-nav a.active {
      color: #1a56db;
    }
    
    .hamburger {
      display: none; /* Sembunyi Hamburger di Laptop */
    }
  }

  /* --- TOMBOL HAMBURGER --- */
  .hamburger {
    background: none;
    border: none;
    cursor: pointer;
    display: flex;
    flex-direction: column;
    gap: 5px;
    padding: 5px;
  }
  
  .hamburger span {
    display: block;
    width: 25px;
    height: 2px;
    background-color: #333;
    border-radius: 2px;
  }

  /* --- MENU MOBILE (YANG DIREVISI) --- */
  .mobile-nav {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    background: rgba(0,0,0,0.5); /* Background gelap transparan */
    visibility: hidden;
    opacity: 0;
    transition: all 0.3s;
    z-index: 2000;
  }

  .mobile-nav.active {
    visibility: visible;
    opacity: 1;
  }

  .mobile-nav-content {
    background: white;
    width: 280px; /* Lebar panel menu */
    height: 100%;
    transform: translateX(-100%); /* Geser ke kiri (sembunyi) */
    transition: transform 0.3s ease;
    display: flex;
    flex-direction: column;
    box-shadow: 2px 0 10px rgba(0,0,0,0.1);
  }

  .mobile-nav.active .mobile-nav-content {
    transform: translateX(0); /* Muncul */
  }

  .mobile-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 1.5rem;
      border-bottom: 1px solid #f3f4f6;
  }

  .menu-title {
      font-weight: 700;
      color: #111827;
      font-size: 1.1rem;
  }

  .close-btn {
      background: none;
      border: none;
      font-size: 2rem;
      line-height: 1;
      color: #9ca3af;
      cursor: pointer;
  }

  /* --- TOMBOL MENU MOBILE (Revisi Height Disini) --- */
  .mobile-links {
      display: flex;
      flex-direction: column;
      padding: 0.5rem 0;
  }

  .mobile-links a {
    display: block;
    
    /* REVISI UKURAN TOMBOL: Lebih tipis */
    padding: 0.75rem 1.5rem; 
    
    font-size: 0.95rem;
    color: #374151;
    text-decoration: none;
    font-weight: 500;
    border-bottom: 1px solid #f9fafb; /* Garis tipis pemisah */
    transition: background 0.2s;
  }

  .mobile-links a:hover {
    background-color: #eff6ff; /* Biru muda saat disentuh */
    color: #1a56db;
    padding-left: 1.8rem; /* Efek geser sedikit saat hover */
  }
</style>
